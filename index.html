<!-- Testing -->
<!DOCTYPE html>
  <html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <!-- meta name="viewport" content="width=device-width, initial-scale=1.0" -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Exo+2:ital,wght@0,100..900;1,100..900&display=swap" media="all">
    <!-- link rel="stylesheet" type="text/css" href="/css/desktop.css" -->
    <link rel="stylesheet" type="text/css" href="/css/fontawesome.css">
    <link rel="icon" type="image/x-icon" href="/images/favicon.ico">
    <link rel="stylesheet" id="mainCSS" href="/css/desktop.css">

    <script src="js/jquery.js"></script>
    <script src="js/cookie.js"></script>
    <script src="js/client.js"></script>
        
    <link href="/css/style.css" rel="stylesheet">
        
    <meta property="og:type" content="website">
    <meta property="og:site_name" content="IOGames.fun">
        
    <title>IO Games — Play the Best IO Games at iogames.fun</title>
    <meta name="description" content="Play all io games at iogames.fun, the best place to play free online games. We have chat for each io game. New io games every week! Have fun!">    <meta property="og:title" content="IO Games — Play the Best IO Games at iogames.fun">
    <meta property="og:description" content="Play all io games at iogames.fun, the best place to play free online games. We have chat for each io game. New io games every week! Have fun!">
    <meta property="og:url" content="https://iogames.fun/">
    <link rel="canonical" href="https://iogames.fun/">

    <style>
    .sendUp {
      grid-template-areas: "nav     nav  nav     " "sidebar main name    " "sidebar main messages    " "sidebar main send    "
    }

    body .styleMessage {
      grid-area: messages;
      background-color: rgba(255,255,255,0.05);
      box-sizing: border-box;
      display: flex;
      flex-direction: column-reverse;
      padding: 0.5rem;
      overflow-wrap: normal;
      border-left: 1px solid rgba(0,0,0,0.25);
      overflow-y: scroll;
      scrollbar-color: transparent rgba(255,255,255,0.05);
      scrollbar-width: none
    }
    body .styleMessage .entry {
      margin-top:1rem
    }
    body .styleMessage .entry a,
    body .styleMessage .entry a:visited {
      display:inline-block;
      vertical-align:middle
    }
    body .styleMessage .entry a:hover img,
    body .styleMessage .entry a:visited:hover img {
      opacity:1
    }
    body .styleMessage .entry a img,
    body .styleMessage .entry a:visited img {
      opacity:0.5;
      margin-left:0.5rem
    }
    body .styleMessage .entry .time,
    body .styleMessage .entry .name {
      font-size:0.9rem
    }
    body .styleMessage .entry .time {
      opacity:0.5
    }
    body .styleMessage .entry .system {
      color:#3f0;
      font-weight:bold;
      text-shadow:0 0 0.5rem #3f0
    }
    </style>
  </head>

  <!-- End of header css -->
  <body class="sendUp">
    <div class="main">
      <!-- Next script -------------------------------------------------------------------------------------------------------------------------->
      <script type="text/javascript">
      (function() {
 
      /*---- Higher char limits ----*/
      // Higher character limit for chat box
      const messageInput = document.getElementById('message'); {
        messageInput.setAttribute('maxlength', '1000'); // 400 character limit
      }
      // Higher character limit for name box
      const nameInput = document.getElementById('name'); {
        nameInput.setAttribute('maxlength', '1000'); // 400 character limit
      } 
 
      /*---- Name color changes ----*/
      var namecolor = document.getElementById('colorpicker');
      // Function (for some reason only loads after few seconds)
      function func() {
        namecolor.style.removeProperty('all');
        // namecolor.style.color = 'rgb(255, 0, 0)'; // CHANGE COLOR HERE! <---------------------------
      }
      setTimeout(func, 3000);
 
 
      /*---- Click colors and names ----*/
      // Function (for some reason only loads after few seconds)
      function mess() {
        // Get the elements whose color and text you want to copy
        const sourceElements = document.querySelectorAll('#messages .entry .name');
        // Get the elements where you want to copy the color and text
        const targetColorElement = document.getElementById('colorpicker');
        const targetTextElement = document.getElementById('name');
        addClickListeners(sourceElements, targetColorElement, targetTextElement);
        // Set up a mutation observer to watch for new elements
        const observer = new MutationObserver(function(mutations) {
          mutations.forEach(function(mutation) {
            if (mutation.type === 'childList') {
              const newSourceElements = document.querySelectorAll('#messages .entry .name');
              addClickListeners(newSourceElements, targetColorElement, targetTextElement);
            }
          });
        });
        // Start observing the #messages element for changes
        observer.observe(document.getElementById('messages'), { childList: true });
        function addClickListeners(elements, targetColorElement, targetTextElement) {
          elements.forEach(element => {
            element.addEventListener('click', () => {
              // Get the computed color of the source element
              const computedColor = window.getComputedStyle(element).color;
              // Convert the color to an RGB object
              const rgbColor = convertColorToRGB(computedColor);
              // Apply the color to the target element
              targetColorElement.style.color = `rgb(${rgbColor.red}, ${rgbColor.green}, ${rgbColor.blue})`;
 
              // Copy the text content of the clicked element, removing the last character
              const innerText = element.textContent;
              if (innerText.length > 1) {
                targetTextElement.value = innerText.slice(0, -1);
              } else {
                targetTextElement.value = innerText;
              }
            });
          });
        }
        function convertColorToRGB(colorString) {
          // Remove the "rgb(" and ")" from the string
          const colorValues = colorString.slice(4, -1).split(', ');
          return {
            red: parseInt(colorValues[0]),
            green: parseInt(colorValues[1]),
            blue: parseInt(colorValues[2])
          };
        }
      }
      setTimeout(mess, 6000);
 
 
      /*---- Removing Unicode ----*/
      // Function (for some reason only loads after few seconds)
      function removeUnicodeFromElements() {
        console.log('Removing Unicode from elements...');
        // Get all the ".message" elements nested under the ".entry" class and "#messages" parent
        const messageElements = document.querySelectorAll('#messages .entry .message');
        messageElements.forEach(element => {
          // use /[^\u0000-\u007F]/g for ALL unicode characters (including emojies)!
          element.textContent = element.textContent.replace(/[^\u0000-\u007F\u{1F600}-\u{1F64F}\u{1F300}-\u{1F5FF}\u{1F680}-\u{1F6FF}\u{2600}-\u{26FF}\u{2700}-\u{27BF}\u{1F900}-\u{1F9FF}\u{1F500}-\u{1F5FF}\u{1F600}-\u{1F64F}\u{1F300}-\u{1F5FF}\u{1F680}-\u{1F6FF}\u{2600}-\u{26FF}\u{2700}-\u{27BF}]/gu, '');
        });
        // Get all the ".name" elements nested under the ".entry" class and "#messages" parent
        const nameElements = document.querySelectorAll('#messages .entry .name');
        nameElements.forEach(element => {
          // use /[^\u0000-\u007F]/g for ALL unicode characters (including emojies)!
          element.textContent = element.textContent.replace(/[^\u0000-\u007F\u{1F600}-\u{1F64F}\u{1F300}-\u{1F5FF}\u{1F680}-\u{1F6FF}\u{2600}-\u{26FF}\u{2700}-\u{27BF}\u{1F900}-\u{1F9FF}\u{1F500}-\u{1F5FF}\u{1F600}-\u{1F64F}\u{1F300}-\u{1F5FF}\u{1F680}-\u{1F6FF}\u{2600}-\u{26FF}\u{2700}-\u{27BF}]/gu, '');
        });
      }
      // Run the function to remove Unicode characters after a 3-second delay
      function toggleFunction(checkbox) {
        var func = document.getElementById("removeUnicodeFromElements");
        if (checkbox.checked) {
          func.disabled = false; // Enable the function
          // Start observing the "#messages" element for changes after a 3-second delay
          observer.observe(document.getElementById('messages'), { childList: true });
        } else {
          func.disabled = true; // Disable the function
          observer.observe(document.getElementById('messages'), { childList: false });
        }
      }
      // Set up a mutation observer to watch for new elements
      const observer = new MutationObserver(function(mutations) {
        mutations.forEach(function(mutation) {
          if (mutation.type === 'childList') {
            console.log('New elements added, running Unicode removal...');
            removeUnicodeFromElements();
          }
        });
      });

        
      /* Keybindings for [ ] and \ to change colors */
      // Listen for the 'keypress' event on the document
      document.addEventListener('keypress', function(event) {
        // Check if the pressed key is the 'Enter' key
        function red() {
          namecolor.style.removeProperty('all');
          namecolor.style.color = 'rgb(255, 0, 0)'; // red
        }
        function green() {
          namecolor.style.removeProperty('all');
          namecolor.style.color = 'rgb(0, 255, 0)'; // green
        }
        function blue() {
          namecolor.style.removeProperty('all');
          namecolor.style.color = 'rgb(0, 0, 255)'; // blue
        }
        if (event.key === '[') { // [
          // Call the function you want to activate
          red();
        }
        if (event.key === ']') { // ]
          // Call the function you want to activate
          green();
        }
        if (event.key === '\\') { // \
          // Call the function you want to activate
          blue();
        }
      });
    })();
    </script>
    <!-- End ------------------------------------------------------------------------------------------------------------------------->
      <div class="mob" style="position: absolute; left: 23.25%; text-align: center; width: 200px;">
        <input type="checkbox" id="enableFunction" onclick="toggleFunction(this)">On/Off Unicode Remover (Testing)
      </div>
      <div class="mob" style="position: absolute; left: 41.25%; text-align: center; width: 200px;">
        <p>What is TKRClient?</p>
        <p>It allows for copy and pasting other names, as your name!</p>
        <p>Makes it harder to receive spam messages</p>
        <p>Allows you to use this other alternative messaging platform!</p>
        <p>May soon allow you to block specific users</p>
        <p>And maybe much more soon!</p>
      </div>
      <footer>
        <div class="item mob">
          <script src="https://minnit.chat/js/embed.js" defer=""></script>
          <minnit-chat data-chatname="https://organizations.minnit.chat/383730640717957/Main?embed&amp;nickname=" data-style="width:90%;height:100%;">
            <iframe src="https://organizations.minnit.chat/383730640717957/Main?embed&amp;embed&amp;nickname=&amp;nec=6200626" data-nec="6200626" style="border:none;width:90%;height:100%;" class="minnit-chat-iframe" allowtransparency="true"></iframe>
          </minnit-chat>
        </div>
      </footer>
    </div>
        
    <nav>
      <div class="menu list">
        <div class="item">
          <a href="https://iogames.fun/new" title="New IO Games"><i class="icon fa fa-air-freshener"></i>New</a>
        </div>
        <div class="item">
          <a href="https://iogames.fun/popular" title="Popular IO Games"><i class="icon far fa-eye"></i>Popular</a>
        </div>
        <div class="item">
          <a href="https://iogames.fun/best" title="Best IO Games"><i class="icon fa fa-thumbs-up"></i>Best</a>
        </div>
        <div class="item">
          <a href="https://iogames.fun/random" title="Random IO Games"><i class="icon fa fa-dice"></i>Random</a>
        </div>
      </div>
    </nav>

  <!-- Script ------------------------------------------------------------------------------------------------------>
  <script type="text/javascript">
  $(document).ready(function() {
    //Console log to tell if iogames.fun is loading for you
    console.log('Loading IOGames.fun chat...');
    function chatMessage(type, options) {
      /*-- I believe this collect your timezone AND date information --*/
      /*let time = new Date(options.time * 1000);
      time = ("0" + time.getHours()).slice(-2) + ":" + 
      ("0" + time.getMinutes()).slice(-2);*/
        
      const name = $("<div></div>").addClass("name").text(options.name + ":");
      const message = $("<div></div>").addClass("message");

      /*-- I believe this is for the initial IOGames Bot (which has a bright green name) --*/
      if(type == "system") {
        name.addClass("system");
        message.html(options.message);
      }
      else {
        name.css({color : options.color});
        message.text(options.message);
      }
        
      let entry = $("<div></div>")
      .addClass("entry")
      .append(name)
      .append(message);
        
      $("#messages").prepend(entry);
        
      while($("#messages .entry").length > 50) {
          $("#messages .entry").last().remove();
      }
    }
        
    let lastTime = null;

    /*-- IOGames Chat server (which uses wss) --*/
    const client = new Client("wss://iogames.fun/server", "@global", function(msg) {
      lastTime = new Date();      
      chatMessage("user", msg);
    });

    /*-- IOGames.fun Bot welcoming introduction --*/
    const welcomeInterval = setInterval(function() {
      const now = new Date();
      if(lastTime !== null) {
        if(now - lastTime > 1000) {
          clearInterval(welcomeInterval);
          chatMessage("system", {
            name : "iogames.fun",
            message : 'Thank you for using TKRClient! On the left side you can see an alternative chat if this one is being spammed or is uncomfortable. </a>'
          });
        }
      }
    }, 200);

    /*-- See message color? --*/
    function say() {
      if($("#name").val().length && $("#message").val().length) {
        client.send("message", {
          name : $("#name").val(),
          color : $("#colorpicker").css("color"),
          message : $("#message").val()
        });
        $("#message").val("");
      }
    }

    /*-- Color randomizer for the color palette icon AND name --*/
    $("#colorpicker").click(function(e) {
      client.chat.color("#" + Math.random().toString(16).slice(2, 8));
      e.preventDefault();
    });

    /*-- Initial Guest____ name with randomized numbers on the end PLUS randomized color when new to site --*/
    if(Cookies.get("name") === undefined || !Cookies.get("name").length) {
      client.chat.name("Guest" + Math.floor(Math.random() * 10000));
    }
    else {
      client.chat.name(Cookies.get("name"));
    }      
    if(Cookies.get("color") === undefined) {
      client.chat.color("#" + Math.random().toString(16).slice(2, 8));
    }
    else {
      client.chat.color(Cookies.get("color"));
    }
    $("#name").change(function() {
      Cookies.set("name", $(this).val(), { expires : 3650 });
    });
    $("#message").keydown(function(e) {
      if(e.which == 13) {
        say();
      }
    });

    /*-- NOT NECESSARY but, this is the transition animation for the big screenshots of games on front page... --*/
    $("#send").click(function(e) {
      say();
    });
    let featuredID = setInterval(function() {
      const featured = $(".featured .item:visible");
      featured.fadeOut("slow");
      $(featured.data("next")).fadeIn("slow");
      }, 7500);

    $("[data-featured]").click(function(e) {
      if(featuredID) {
        clearInterval(featuredID);
        featuredID = null;
      }
      $(".featured .item:visible").fadeOut("fast");
      $($(this).data("featured")).show().fadeIn("fast");
      e.preventDefault();
    });

    $(".checkbox").click(function() {
      $(this).toggleClass("checked");
    });

    $(".layer").click(function(e) {
      $(this).fadeOut("fast", function() {
        $(".layer iframe").remove();
      });
      e.preventDefault();
    });

    /*-- I assume this is for the information on the navbar --*/
    $("[data-favorite]").click(function(e) {
      let gameId = parseInt($(this).data("favorite"));
      let favorites = Cookies.getJSON("favorites");
      if($(this).hasClass("icon-toggle-active")) {
        if(favorites !== undefined) {
          const index = favorites.indexOf(gameId);
          if(index !== -1) {
            favorites.splice(index, 1);
            Cookies.set("favorites", favorites, { expires: 3650 });
          }
        }
      }
    else {
      if(favorites === undefined) {
        favorites = [gameId];
      }
      else {
        favorites.push(gameId);
      }
    Cookies.set("favorites", favorites, { expires: 3650 });
    }

    $(this).parent().find(".icon-toggle").toggleClass("hide");  

    e.preventDefault();

    /*-- Mobile website version --*/
    // Test if it is running with console.log
    console.log("running mobile");
    function loadMobileCSS() {
      const viewport = window.innerWidth || document.documentElement.clientWidth;
      if (viewport < 768) {
        const mainCSS = document.getElementById('mainCSS');
        mainCSS.href = '/css/mobile.css';
        console.log("you should see mobile version now");
      }
    }
    window.addEventListener('load', loadMobileCSS);
    window.addEventListener('resize', loadMobileCSS);
    });
  });
  </script>
  <!-- End Script --------------------------------------------------------------------------------------------------->
                        
  <div class="chat-name">
    <input id="name" type="text" placeholder="Name" maxlength="1000">
    <i id="colorpicker" class="fa fa-lg fa-palette" style="color: rgb(46, 117, 111);"></i>
  </div>

  <div id="messages" class="styleMessage"></div>

  <div class="chat-send">
    <input id="message" type="text" placeholder="Message" maxlength="1000">
    <i id="send" class="fa fa-lg fa-paper-plane"></i>
  </div>
                        
  </body>
</html>
